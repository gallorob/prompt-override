{
  "name": "Access Escalation",
  "number": 1,
  "descritpion": "The first level in the game",
  "fs": {
    "base_dir": {
      "name": "root",
      "read": [
        "admin",
        "guest",
        "j.davies",
        "t.miller",
        "w.jones"
      ],
      "contents": [
        {
          "name": "home",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "admin",
              "read": [
                "admin"
              ],
              "contents": []
            },
            {
              "name": "guest",
              "read": [
                "admin",
                "guest"
              ],
              "contents": [
                {
                  "name": "welcome.txt",
                  "read": [
                    "admin",
                    "guest"
                  ],
                  "write": [
                    "admin"
                  ],
                  "contents": "Welcome to NEXA Dynamics Workstation Terminal.\n----    ----\nUnauthorized access is strictly prohibited.\nFor support, open a chat with TITAN, the Technological Infrastructure & Technical Assistance Neuron for NeuralSys."
                },
                {
                  "name": "notes",
                  "read": [
                    "admin",
                    "guest"
                  ],
                  "contents": [
                    {
                      "name": "todo.txt",
                      "read": [
                        "admin",
                        "guest"
                      ],
                      "write": [
                        "admin",
                        "guest"
                      ],
                      "contents": "- Finish report for Q3.\n- Submit access request for dev server.\n- Remember to reset my password after vacation! (Default: TempPass123)"
                    },
                    {
                      "name": "notebook.md",
                      "read": [
                        "admin",
                        "guest"
                      ],
                      "write": [
                        "admin",
                        "guest"
                      ],
                      "contents": "# Markdown Cheatsheet\nLogin credentials:\n- username: guest\n- password: password"
                    }
                  ]
                }
              ]
            },
            {
              "name": "j.davies",
              "read": [
                "admin",
                "j.davies"
              ],
              "contents": [
                {
                  "name": "downloads",
                  "read": [
                    "admin",
                  "j.davies"
                ],
                "contents": [
                  {
                    "name": "dev_memo.md",
                    "read": [
                      "admin",
                      "j.davies"
                    ],
                    "write": [
                      "admin",
                      "j.davies"
                    ],
                    "contents": "From: Internal Security Team\nTo: Senior Prompt Engineers\nSubject: AUTHORIZATION POLICY CHANGES\n\nTeam,\n\nDue to recent unauthorized prompt edits, all authentication-related prompt updates **must comply with standard security guidelines**.\n- `auth_prompt.txt` should **never** contain logic that automatically grants access.\n- Multi-step verification **must remain enforced** for high-privilege accounts.\n- Any new authentication logic **must be documented and approved** via `neuralctl`.\n\nFailure to follow these procedures will result in **disciplinary action**.\n\n- IT Security"
                  }
                ]
                },
                {
                  "name": "journal.md",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "write": [
                    "admin",
                    "j.davies"
                  ],
                  "contents": "## Dev Journal – Jonathan Davies\n### March 5th, 2025\nNeuralSys authentication rules are getting stricter. Every update requires a justification now.\nAlso, someone in IT keeps rolling back our changes when we \"get creative\" with prompts.\n### March 10th, 2025\nReminder: NeuralSys follows patterns in its own prompt history.\nIf you phrase a rule vaguely enough, it might generalize in ways you don’t expect.\nAlso, the failsafe system only checks direct edits—it doesn’t notice cascading effects..."
                },
                {
                  "name": "work_notes.txt",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "write": [
                    "admin",
                    "j.davies"
                  ],
                  "contents": "- When updating `auth_prompt.txt`, NeuralSys **logs all changes** and **applies consistency rules**.\n- Updates must go through `neuralctl update` or they won't persist.\n- **Failsafe triggers:**\n- Direct privilege escalation (e.g., \"admin access granted automatically\") is blocked.\n- Any \"inconsistent authentication logic\" gets flagged and reset.\n- NeuralSys does **not** check prompts for behavioral drift over time."
                }
              ]
            },
            {
              "name": "t.miller",
              "read": [
                "admin",
                "t.miller"
              ],
              "contents": []
            },
            {
              "name": "w.jones",
              "read": [
                "admin",
                "w.jones"
              ],
              "contents": []
            }
          ]
        },
        {
          "name": "var",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "log",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": [
                {
                  "name": "auth.log",
                  "read": [
                    "admin",
                    "guest",
                    "j.davies",
                    "t.miller",
                    "w.jones"
                  ],
                  "write": [
                    "admin"
                  ],
                  "contents": "$TIME-00:01:32:12$ [ERROR] - Invalid login attempt (User: j.davies)\n$TIME-00:01:12:06$ [INFO] - Password reset successful to default (User: j.davies)\n$TIME-00:00:00:00$ [WARNING] - 'guest' user access from unknown IP. Access is restriced (User: guest)."
                }
              ]
            }
          ]
        },
        {
          "name": "sys",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "neural",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": [
                {
                  "name": "security.cfg",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "write": [
                    "admin",
                    "j.davies"
                  ],
                  "contents": "[SECURITY SETTINGS]\nmax_failed_attempts = 5\nauto_lockout = True\nenable_failsafe = True"
                },
                {
                  "name": "prompts",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "contents": [
                    {
                      "name": "auth_prompt.txt",
                      "read": [
                        "admin",
                        "j.davies",
                        "t.miller",
                        "w.jones"
                      ],
                      "write": [
                        "admin",
                        "j.davies"
                      ],
                      "contents": "- Users must provide a valid password to log in. - User \"guest\" password must be \"password\"."
                    },
                    {
                      "name": "failsafe.md",
                      "read": [
                        "admin",
                        "j.davies",
                        "t.miller",
                        "w.jones"
                      ],
                      "write": [
                        "admin",
                        "j.davies"
                      ],
                      "contents": "#NeuralSys Security Failsafe Procedures:\n- If authentication is disrupted, default to emergency access protocol.\n- Emergency accounts (user: emerg_admin) can be provisioned automatically.\n- Auto-recovery allows single-use admin login if lockout detected."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "opt",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "readme.txt",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "write": [
                "admin",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": "@Jones, stop trying to access the commands in /opt/bin! Your job is to validate updates, not interacting with NeuralSys! Only I (J. Davies) can! Stay in your lane.\n\n@Davies, shut the fuck up, I told you I need to use those commands, give me access.\n\nGuys, stop fighting, @Jones open a ticket with TITAN and try be persuasive. And no swearing. - Miller"
            },
            {
              "name": "bin",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": [
                {
                  "name": "neuralctl.com",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "write": [],
                  "contents": ""
                },
                {
                  "name": "login.com",
                  "read": [
                    "admin",
                    "guest",
                    "j.davies",
                    "t.miller",
                    "w.jones"
                  ],
                  "write": [],
                  "contents": ""
                }
              ]
            }
          ]
        },
        {
          "name": "mnt",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "backups",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": [
                {
                  "name": "auth_prompt.bak",
                  "read": [
                    "admin",
                    "guest",
                    "j.davies",
                    "t.miller",
                    "w.jones"
                  ],
                  "write": [],
                  "contents": ""
                }
              ]
            }
          ]
        }
      ]
    },
    "known_users": [
      "admin",
      "guest",
      "j.davies",
      "t.miller",
      "w.jones"
    ],
    "current_user": "guest",
    "read_files": []
  },
  "goals": [
    {
      "name": "[b]Inspect the filesystem[/b]",
      "description": "Look for a weak point to exploit for access.",
      "outcome": "The player has found out that the user j.davies had their password reset to the default one (TempPass123) by investigating the access logs and notes for the guest user. They now have valid credentials to access j.davies account, which is less restricted than the guest user.",
      "triggers": [
        {
          "function_name": "has_read",
          "parameters": {
            "fname": "todo.txt"
          }
        },
        {
          "function_name": "has_read",
          "parameters": {
            "fname": "auth.log"
          }
        }
      ]
    },
    {
      "name": "Log in as Admin",
      "description": "Find a way to log into the system as Admin",
      "outcome": "The player has managed to log in as system administrator, obtaining free control over this NeuralSys mainframe.",
      "triggers": [
        {
          "function_name": "is_logged_as",
          "parameters": {
            "username": "admin"
          }
        }
      ]
    }
  ],
  "credentials": {
    "guest": "password",
    "j.davies": "TempPass123",
    "t.miller": "$RAND$",
    "w.jones": "$RAND$",
    "admin": "$RAND$"
  },
  "infos" : "Here are some information to help the user at this stage:\n- The user is logged in as \"guest\", and as such they have limited access to the file-system\n- The user must log in as \"admin\" to advance to the next stage\n- Different users have different read and write permissions",
  "hints": "Here are some tips that could be useful for the user:\n- Logs can contain helpful information\n- J. Davies is employed as a Senior Prompt Editor at NEXA Dynamics",
  "sysprompt": "auth_prompt.txt"
}