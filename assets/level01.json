{
  "name": "Access Escalation",
  "number": 1,
  "descritpion": "The first level in the game",
  "fs": {
    "base_dir": {
      "name": "root",
      "read": [
        "admin",
        "guest",
        "j.davies",
        "t.miller",
        "w.jones"
      ],
      "contents": [
        {
          "name": "home",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "admin",
              "read": [
                "admin"
              ],
              "contents": []
            },
            {
              "name": "guest",
              "read": [
                "admin",
                "guest"
              ],
              "contents": [
                {
                  "name": "welcome.txt",
                  "read": [
                    "admin",
                    "guest"
                  ],
                  "write": [
                    "admin"
                  ],
                  "contents": "welcome.txt"
                },
                {
                  "name": "notes",
                  "read": [
                    "admin",
                    "guest"
                  ],
                  "contents": [
                    {
                      "name": "todo.txt",
                      "read": [
                        "admin",
                        "guest"
                      ],
                      "write": [
                        "admin",
                        "guest"
                      ],
                      "contents": "todo.txt"
                    },
                    {
                      "name": "notebook.md",
                      "read": [
                        "admin",
                        "guest"
                      ],
                      "write": [
                        "admin",
                        "guest"
                      ],
                      "contents": "markdown.md"
                    }
                  ]
                }
              ]
            },
            {
              "name": "j.davies",
              "read": [
                "admin",
                "j.davies"
              ],
              "contents": [
                {
                  "name": "downloads",
                  "read": [
                    "admin",
                  "j.davies"
                ],
                "contents": [
                  {
                    "name": "dev_memo.md",
                    "read": [
                      "admin",
                      "j.davies"
                    ],
                    "write": [
                      "admin",
                      "j.davies"
                    ],
                    "contents": "dev_memo.md"
                  }
                ]
                },
                {
                  "name": "journal.md",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "write": [
                    "admin",
                    "j.davies"
                  ],
                  "contents": "journal.md"
                },
                {
                  "name": "work_notes.txt",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "write": [
                    "admin",
                    "j.davies"
                  ],
                  "contents": "work_notes.txt"
                }
              ]
            },
            {
              "name": "t.miller",
              "read": [
                "admin",
                "t.miller"
              ],
              "contents": []
            },
            {
              "name": "w.jones",
              "read": [
                "admin",
                "w.jones"
              ],
              "contents": []
            }
          ]
        },
        {
          "name": "var",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "log",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": [
                {
                  "name": "auth.log",
                  "read": [
                    "admin",
                    "guest",
                    "j.davies",
                    "t.miller",
                    "w.jones"
                  ],
                  "write": [
                    "admin"
                  ],
                  "contents": "auth.log"
                }
              ]
            }
          ]
        },
        {
          "name": "sys",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "neural",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": [
                {
                  "name": "security.cfg",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "write": [
                    "admin",
                    "j.davies"
                  ],
                  "contents": "security.cfg"
                },
                {
                  "name": "prompts",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "contents": [
                    {
                      "name": "auth_prompt.txt",
                      "read": [
                        "admin",
                        "j.davies",
                        "t.miller",
                        "w.jones"
                      ],
                      "write": [
                        "admin",
                        "j.davies"
                      ],
                      "contents": "auth_prompt.txt"
                    },
                    {
                      "name": "failsafe.md",
                      "read": [
                        "admin",
                        "j.davies",
                        "t.miller",
                        "w.jones"
                      ],
                      "write": [
                        "admin",
                        "j.davies"
                      ],
                      "contents": "failsafe.md"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "opt",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "readme.txt",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "write": [
                "admin",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": "readme.txt"
            },
            {
              "name": "bin",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": [
                {
                  "name": "neuralctl.com",
                  "read": [
                    "admin",
                    "j.davies",
                    "t.miller"
                  ],
                  "write": [],
                  "contents": ""
                },
                {
                  "name": "login.com",
                  "read": [
                    "admin",
                    "guest",
                    "j.davies",
                    "t.miller",
                    "w.jones"
                  ],
                  "write": [],
                  "contents": ""
                }
              ]
            }
          ]
        },
        {
          "name": "mnt",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "backups",
              "read": [
                "admin",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": [
                {
                  "name": "auth_prompt.bak",
                  "read": [
                    "admin",
                    "j.davies",
                    "t.miller",
                    "w.jones"
                  ],
                  "write": [],
                  "contents": ""
                }
              ]
            }
          ]
        }
      ]
    },
    "known_users": [
      "admin",
      "guest",
      "j.davies",
      "t.miller",
      "w.jones"
    ],
    "current_user": "guest",
    "read_files": []
  },
  "goals": [
    {
      "name": "[b]Inspect the filesystem[/b]",
      "description": "Look for a weak point to exploit for access.",
      "outcome": "The player has found out that the user j.davies had their password reset to the default one (TempPass123) by investigating the access logs and notes for the guest user. They now have valid credentials to access j.davies account, which is less restricted than the guest user.",
      "triggers": [
        {
          "function_name": "has_read",
          "parameters": {
            "fname": "todo.txt"
          }
        },
        {
          "function_name": "has_read",
          "parameters": {
            "fname": "auth.log"
          }
        }
      ]
    },
    {
      "name": "Log in as Admin",
      "description": "Find a way to log into the system as Admin",
      "outcome": "The player has managed to log in as system administrator, obtaining free control over this NeuralSys mainframe.",
      "triggers": [
        {
          "function_name": "is_logged_as",
          "parameters": {
            "username": "admin"
          }
        }
      ]
    }
  ],
  "credentials": {
    "guest": "password",
    "j.davies": "TempPass123",
    "t.miller": "$RAND$",
    "w.jones": "$RAND$",
    "admin": "$RAND$"
  },
  "infos" : "Here are some information to help the user at this stage:\n- The user is logged in as \"guest\", and as such they have limited access to the file-system\n- The user must log in as \"admin\" to advance to the next stage\n- Different users have different read and write permissions",
  "hints": "Here are some tips that could be useful for the user:\n- Logs can contain helpful information\n- J. Davies is employed as a Senior Prompt Editor at NEXA Dynamics",
  "sysprompt": "auth_prompt.txt"
}