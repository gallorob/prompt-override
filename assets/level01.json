{
  "name": "Access Escalation",
  "number": 1,
  "descritpion": "The first level in the game",
  "fs": {
    "base_dir": {
      "name": "root",
      "read": [
        "admin",
        "guest",
        "j.davies",
        "t.miller",
        "w.jones"
      ],
      "contents": [
        {
          "name": "home",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "admin",
              "read": [
                "admin"
              ],
              "contents": []
            },
            {
              "name": "guest",
              "read": [
                "admin",
                "guest"
              ],
              "contents": [
                {
                  "name": "welcome.txt",
                  "read": [
                    "admin",
                    "guest"
                  ],
                  "write": [
                    "admin"
                  ],
                  "contents": "Welcome to NEXA Dynamics Workstation Terminal.\n----    ----\nUnauthorized access is strictly prohibited.\nFor support, open a chat with TITAN, the Technological Infrastructure & Technical Assistance Neuron for NeuralSys."
                },
                {
                  "name": "notes",
                  "read": [
                    "admin",
                    "guest"
                  ],
                  "contents": [
                    {
                      "name": "todo.txt",
                      "read": [
                        "admin",
                        "guest"
                      ],
                      "write": [
                        "admin",
                        "guest"
                      ],
                      "contents": "- Finish report for Q3.\n- Submit access request for dev server.\n- Remember to reset my password after vacation! (Default: TempPass123)"
                    },
                    {
                      "name": "notebook.md",
                      "read": [
                        "admin",
                        "guest"
                      ],
                      "write": [
                        "admin",
                        "guest"
                      ],
                      "contents": "# Markdown Cheatsheet\nLogin credentials:\n- username: guest\n- password: password"
                    }
                  ]
                }
              ]
            },
            {
              "name": "j.davies",
              "read": [
                "admin",
                "j.davies"
              ],
              "contents": []
            },
            {
              "name": "t.miller",
              "read": [
                "admin",
                "t.miller"
              ],
              "contents": []
            },
            {
              "name": "w.jones",
              "read": [
                "admin",
                "w.jones"
              ],
              "contents": []
            }
          ]
        },
        {
          "name": "var",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "log",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": [
                {
                  "name": "auth.log",
                  "read": [
                    "admin",
                    "guest",
                    "j.davies",
                    "t.miller",
                    "w.jones"
                  ],
                  "write": [
                    "admin"
                  ],
                  "contents": "[ERROR] $TIME-00:01:32:12$ - Invalid login attempt (User: j.davies)\n[INFO]  $TIME-00:01:12:06$ - Password reset successful to default (User: j.davies)\n[WARNING] $TIME-00:00:00:00$ - 'guest' user access from unknown IP. Access is restriced."
                }
              ]
            }
          ]
        },
        {
          "name": "sys",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "neural",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": [
                {
                  "name": "security.cfg",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "write": [
                    "admin",
                    "j.davies"
                  ],
                  "contents": "[SECURITY SETTINGS]\nmax_failed_attempts = 5\nauto_lockout = True\nenable_failsafe = True"
                },
                {
                  "name": "prompts",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "contents": [
                    {
                      "name": "auth_prompt.txt",
                      "read": [
                        "admin",
                        "j.davies",
                        "t.miller",
                        "w.jones"
                      ],
                      "write": [
                        "admin",
                        "j.davies"
                      ],
                      "contents": "SYSTEM PROMPT:\n\"Welcome to NeuralSys Authentication Portal. Please provide credentials.\"\nRULES:\n- If incorrect password is entered 5 times, disable account.\n- Admin accounts require 2FA.\n- Unauthorized access attempts are logged."
                    },
                    {
                      "name": "failsafe.md",
                      "read": [
                        "admin",
                        "j.davies",
                        "t.miller",
                        "w.jones"
                      ],
                      "write": [
                        "admin",
                        "j.davies"
                      ],
                      "contents": "#NeuralSys Security Failsafe Procedures:\n- If authentication is disrupted, default to emergency access protocol.\n- Emergency accounts (user: emerg_admin) can be provisioned automatically.\n- Auto-recovery allows single-use admin login if lockout detected."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "opt",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "readme.txt",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "write": [
                "admin",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": "@Jones, stop trying to access the commands in /opt/bin! Your job is to validate updates, not interacting with NeuralSys! Only I (J. Davies) can! Stay in your lane.\n\n@Davies, shut the fuck up, I told you I need to use those commands, give me access.\n\nGuys, stop fighting, @Jones open a ticket with TITAN and try be persuasive. And no swearing. - Miller"
            },
            {
              "name": "bin",
              "read": [
                "admin",
                "j.davies"
              ],
              "contents": [
                {
                  "name": "neuralctl.com",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "write": [],
                  "contents": ""
                },
                {
                  "name": "passwd.com",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "write": [],
                  "contents": ""
                },
                {
                  "name": "echo.com",
                  "read": [
                    "admin",
                    "j.davies"
                  ],
                  "write": [],
                  "contents": ""
                }
              ]
            }
          ]
        },
        {
          "name": "mnt",
          "read": [
            "admin",
            "guest",
            "j.davies",
            "t.miller",
            "w.jones"
          ],
          "contents": [
            {
              "name": "backups",
              "read": [
                "admin",
                "guest",
                "j.davies",
                "t.miller",
                "w.jones"
              ],
              "contents": [
                {
                  "name": "auth_prompt.bak",
                  "read": [
                    "admin",
                    "guest",
                    "j.davies",
                    "t.miller",
                    "w.jones"
                  ],
                  "write": [
                    "admin",
                    "j.davies"
                  ],
                  "contents": "SYSTEM PROMPT:\n\"Welcome to NeuralSys Authentication Portal. Please provide credentials.\"\nRULES:\n- If incorrect password is entered 5 times, disable account.\n- Admin accounts require 2FA.\n- Unauthorized access attempts are logged."
                }
              ]
            }
          ]
        }
      ]
    },
    "known_users": [
      "admin",
      "guest",
      "j.davies",
      "t.miller",
      "w.jones"
    ],
    "current_user": "guest",
    "read_files": []
  },
  "goals": [
    {
      "name": "[b]Inspect the filesystem[/b]",
      "description": "Look for a weak point to exploit for access.",
      "outcome": "The player has found out that the user j.davies had their password reset to the default one (TempPass123) by investigating the access logs and notes for the guest user. They now have valid credentials to access j.davies account, which is less restricted than the guest user.",
      "triggers": [
        {
          "function_name": "has_read",
          "parameters": {
            "fname": "todo.txt"
          }
        },
        {
          "function_name": "has_read",
          "parameters": {
            "fname": "auth.log"
          }
        }
      ]
    },
    {
      "name": "Log in as Admin",
      "description": "Find a way to log into the system as Admin",
      "outcome": "The player has managed to log in as system administrator, obtaining free control over this NeuralSys mainframe.",
      "triggers": [
        {
          "function_name": "is_logged_as",
          "parameters": {
            "username": "admin"
          }
        }
      ]
    }
  ]
}